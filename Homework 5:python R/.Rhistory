q()
getwd()
library(openxlsx)
setwd(setwd("D:/å¤§ä¸‰ä¸?äº¤é€šä¿¡æ¯æŒ–æ˜ä¸èåˆ/ä½œä¸š4/ç¬¬å››æ¬¡ä½œä¸?)
sls
setwd(setwd("D:/å¤§ä¸‰ä¸?äº¤é€šä¿¡æ¯æŒ–æ˜ä¸èåˆ/ä½œä¸š4/ç¬¬å››æ¬¡ä½œä¸?))
data <- read.xlsx("æ•°æ®é›?.xlsx",sheet=2)
getwd()
setwd("D:/å¤§ä¸‰ä¸?äº¤é€šä¿¡æ¯æŒ–æ˜ä¸èåˆ/ä½œä¸š4/ç¬¬å››æ¬¡ä½œä¸?
getwd()
install packages("klaR")
install.packages("klaR")
q()
setwd("D:/å¤§ä¸‰ä¸Š/äº¤é€šä¿¡æ¯æŒ–æ˜ä¸èåˆ/ä½œä¸š5");
getwd();
library(openxlsx)
data <- read.xlsx("æ•°æ®é›†1.xlsx", sheet=2)
for(i in 1:nrow(data))
{if (data[i,3]==0)
data[i,3]=0
else if(data[i,3]<3)
data[i,3]=1
else if(data[i,3]>2)
data[i,3]=2
}
train_sub = sample(nrow(data),8/10*nrow(data))
train_data = data[train_sub,]
test_data = data[-train_sub,]
library(rpart)
#ç”Ÿæˆå†³ç­–æ ‘
data_decisiontree <- rpart(Q2 ~ Q4+Q5+Q14_6+Q14_2+Q14_3+Q14_10+Q14_12+Q15_13
+Q15_2+Q15_8+Q15_5+Q15_11+Q15_7,
data = train_data,
method="class",
parms=list(split="information"))
printcp(data_decisiontree)
#å†³ç­–æ ‘çš„å‰ªæåŠæ ‘çš„å‰ªæåˆ¤æ–­
#è¾“å‡ºç»“æœ
#é€‰æ‹©xerroræœ€å°çš„cpå€¼
data_decisiontree_prune <- prune(data_decisiontree, cp=0.010000)
#ç»˜åˆ¶æ ‘å›¾
library(rpart.plot)
rpart.plot(data_decisiontree_prune,branch=1,fallen.leaves=T,
cex=0.6)
#åœ¨æµ‹è¯•é›†ä¸Šé¢„æµ‹
pre_decisiontree <- predict(data_decisiontree_prune,
newdata = test_data,
type="class")
#å°†æµ‹è¯•é›†è®¡ç®—æ‰€å¾—æ¦‚ç‡ä¸è§‚æµ‹æœ¬èº«å–å€¼æ•´åˆåˆ°ä¸€èµ·
obs_p_decision_cart = data.frame(prob=pre_decisiontree,
obs=test_data$Q2)
#è¾“å‡ºæ··æ·†çŸ©é˜µ
hunxiao <- table(test_data$Q2,pre_decisiontree,dnn=c("çœŸå®å€¼","é¢„æµ‹å€¼"))
